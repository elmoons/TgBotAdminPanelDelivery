# Telegram Bot Admin Panel for Poizon Price Tracking




## Описание Проекта

Этот Telegram-бот представляет собой административную панель для отслеживания цен на товары с платформы Poizon. Он позволяет администраторам добавлять и удалять товары, а также автоматически обновлять их цены и сохранять данные в Google Таблицах. Проект разработан с использованием современных технологий и обеспечивает удобное управление данными о товарах.

## Ключевые Особенности

*   **Добавление товаров:** Легкое добавление новых товаров с Poizon по ссылке.
*   **Удаление товаров:** Возможность удаления товаров из отслеживания.
*   **Автоматическое обновление цен:** Цены на товары автоматически обновляются в фоновом режиме.
*   **Интеграция с Google Sheets:** Все данные о товарах и ценах сохраняются и синхронизируются с Google Таблицами.
*   **Гибкая настройка ценообразования:** Возможность изменения параметров ценообразования (стоимость доставки, курс валют, коэффициент наценки).
*   **Удобный интерфейс:** Интуитивно понятный Telegram-бот для администраторов.

## Используемые Технологии

*   **Python:** Основной язык разработки.
*   **aiogram:** Фреймворк для создания Telegram-ботов.
*   **SQLAlchemy:** ORM для работы с базой данных.
*   **PostgreSQL:** Реляционная база данных для хранения информации о товарах.
*   **Redis:** Брокер сообщений для Celery.
*   **Celery:** Распределенная система очередей задач для фонового обновления цен.
*   **gspread:** Библиотека для работы с Google Sheets API.
*   **Docker/Docker Compose:** Для контейнеризации и управления сервисами.
*   **Alembic:** Инструмент для миграции баз данных.




## Установка и Запуск

Для запуска проекта вам потребуется установленный Docker и Docker Compose.

1.  **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/elmoons/TgBotAdminPanelDelivery.git
    cd TgBotAdminPanelDelivery
    ```

2.  **Настройте переменные окружения:**

    Создайте файл `.env` в корневой директории проекта на основе `credentials-example.json` и заполните его своими данными:

    ```
    BOT_TOKEN=ВАШ_ТОКЕН_БОТА
    ADMIN_ID=ВАШ_ID_АДМИНА
    GOOGLE_SHEETS_CREDENTIALS_PATH=/app/credentials.json
    ```

    *   `BOT_TOKEN`: Токен вашего Telegram бота, полученный от BotFather.
    *   `ADMIN_ID`: Ваш Telegram ID для доступа к админ-панели.
    *   `GOOGLE_SHEETS_CREDENTIALS_PATH`: Путь к файлу учетных данных Google Sheets (подробнее см. ниже).

3.  **Настройка Google Sheets API:**

    *   Перейдите в Google Cloud Console и создайте новый проект.
    *   Включите Google Sheets API и Google Drive API.
    *   Создайте учетную запись службы (Service Account) и сгенерируйте ключ в формате JSON. Переименуйте скачанный файл в `credentials.json`.
    *   Поместите файл `credentials.json` в директорию `src/` вашего проекта.
    *   Предоставьте доступ к вашей Google Таблице для email адреса вашей сервисной учетной записи.

4.  **Запуск проекта с помощью Docker Compose:**

    ```bash
    docker-compose up --build -d
    ```

    Эта команда соберет образы и запустит все необходимые сервисы: базу данных PostgreSQL, Redis, Telegram бота и Celery воркеры.




## Структура Проекта

```
TgBotAdminPanelDelivery/
├── Dockerfile
├── README.md
├── alembic.ini
├── credentials-example.json
├── docker-compose.yml
├── requirements.txt
└── src/
    ├── __init__.py
    ├── bot.py
    ├── config.py
    ├── connectors/
    │   └── __init__.py
    ├── database/
    │   ├── __init__.py
    │   ├── database.py
    │   └── models.py
    ├── exceptions.py
    ├── main.py
    ├── migrations/
    ├── parse.py
    ├── sheets.py
    ├── tasks/
    │   ├── __init__.py
    │   ├── celery_app.py
    │   └── tasks.py
    └── utils.py
```

## Использование Бота

После успешного запуска бота вы можете взаимодействовать с ним через Telegram. Основные команды:

*   `/start`: Приветственное сообщение и краткое описание бота.
*   `/add_poizon_product`: Добавить новый товар для отслеживания. Бот запросит ссылку на товар с Poizon.
*   `/delete_poizon_product`: Удалить товар из отслеживания по его номеру.
*   `/update_all_products`: Принудительное обновление всех товаров в Google Таблице.
*   `/get_data_about_price`: Показать текущие параметры ценообразования (стоимость доставки, курс, наценка).
*   `/change_data_price`: Изменить параметры ценообразования. Бот запросит новые значения в определенном формате.
*   `/get_all_poizon_products_links`: Получить список всех отслеживаемых товаров с их ссылками.
*   `/google_sheets`: Получить прямую ссылку на Google Таблицу.

## Контакты

Если у вас есть вопросы или предложения, свяжитесь со мной:

*   **Telegram:** @elmoons
*   **GitHub:** [elmoons](https://github.com/elmoons)



